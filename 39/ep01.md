# Ep.01 CHAR vs VARCHAR

- 공통점
  - 문자열 저장용 컬럼
  - 최대 저장 가능 문자 길이 명시 (바이트 수 아님)
- 차이점
  - 값의 실제 크기에 관계없이 고정된 공간 할당 여부
  - 최대 저장 길이: CHAR(255) vs VARCHAR(16383) -> 65535 바이트
  - 저장된 값의 길이 관리 여부 (VARCHAR 와 가변 길이 문자셋 사용하는 CHAR 는 저장된 값 길이 관리)
- CHAR 가변길이 저장의 경우 필요한 바이트만큼 사용하고, 미리 예약하는 빈 공백 공간 없음

## CHAR 타입의 공간 낭비

- 일반적으로 알고 있는 구분 기준
  - 고정된 길이의 값 저장은 CHAR 타입, 그 외의 경우 VARCHAR 타입
  - 하지만 큰 의미 없는 기준
- CHAR 대신 VARCHAR 를 사용하면?
  - CHAR 와 VARCHAR 의 가장 큰 차이는 공간을 미리 예약해두는 것 -> 공간의 낭비가 발생할 수 있음
  - 어떤 경우에는 CHAR 타입의 공간 낭비 심함
    - 저장되는 문자열의 최소 최대 길이 가변 폭이 큰 경우(e.g. 1~100)
  - 하지만 그렇지 않은 경우도 있음
    - 저장되는 문자열의 최소 최대 길이 가변 폭이 작은 경우(e.g. 90~100)
  - 저장되는 값의 길이 변동이 크지 않다면 낭비는 크지 않음

### 칼럼 값의 길이 변경시 작동 방법

처음 레코드가 저장되었던 공간은 delete marking

새롭게 빈 공간에 레코드를 저장

#### CHAR 의 경우

공간을 미리 예약해두었기 때문에, 레코드를 옮겨쓸 필요없이 예약된 공간에 저장

## 문자열 타입 선정

- VARCHAR 보다는 CHAR 선택해야 하는 경우
  - 값의 가변 길이 범위 폭이 좁고
  - 자주 변경되는 경우 (특히 인덱스된 컬럼인 경우)
- 이런 경우 VARCHAR 사용시
  - 데이터 페이지 내부의 조각화 현상 증가
  - CHAR 타입보다 공간 효율 떨어짐
  - 내부적으로 빈번한 Page Reorganize 작업 필요
